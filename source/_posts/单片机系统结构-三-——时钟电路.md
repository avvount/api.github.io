---
title: 单片机系统结构(三)——时钟电路
mathjax: true
date: 2018-04-07 20:12:59
tags:
    - 单片机原理
---
# MCS-51内部时钟电路（CHMOS型）  
内部有一个用于构成振荡器的**高增益反向放大器**，引脚XTAL1和XTAL2分别是此放大器的输入端和输出端。
PD为电源控制寄存器中的一位，PD=1时，可切断振荡器工作，使系统进入低功耗工作状态。

# 石英晶体振荡电路  

将石英晶体、C1、C2作为反馈元件，与内部放大器一起构成一个**自激振荡器**，其发出的脉冲直接送入内部时钟。  
![](https://github.com/avvount/Picture-Bed/raw/master/%E6%8C%AF%E8%8D%A1%E7%94%B5%E8%B7%AF.png)  
- 石英晶体的特性  
    当信号频率为$f_0$时，石英晶体的阻抗最小，信号最易通过  
    振荡频率只取决于谐振频率$f_0$，一般为$1.2MHz~12MHz$
- 电容参数  
    C1和C2一般取30±10PF，电容的大小会略微影响振荡频率及振荡的稳定性  
    在设计印刷线路板时，应使晶体和电容尽可能离单片机近些，以减少寄生电容  

# 外部时钟源接法 
![外接时钟源](https://github.com/avvount/Picture-Bed/raw/master/%E5%A4%96%E6%8E%A5%E6%97%B6%E9%92%9F%E6%BA%90.png)  
  
不同类型的单片机，外部振荡源信号可能接入X2，要参考单片机具体内部电路或手册  
对外部信号的占空比没有什么要求，但要求最小高电平和低电平持续时间应符合产品技术条件的要求（20ns)


# CPU时序  

时序是非常重要的概念，它指明单片机内部及内部与外部相互联系所遵循的规律  
![CPU时序](https://github.com/avvount/Picture-Bed/raw/master/CPU%E6%97%B6%E5%BA%8F.png)  

## 振荡周期  
    为单片机提供定时信号的振荡源的周期  
    
## 状态周期（时钟周期或S周期）  
    是振荡周期的2倍，每个时钟周期被分为2个节拍，即P1、P2  
    在每个时钟周期的前半周期，P1信号有效，这时通常完成算术、逻辑操作
    在每个时钟周期的后半周期，P2信号有效，内部寄存器与寄存器之间的传输一般发生在此状态  
    
## 机器周期  
    一个机器周期由六个时钟周期组成，机器周期是指令执行时间的基本单位  

## 指令周期  
    执行一条指令所需的全部时间，一个指令周期通常包含1、2、4个机器周期  

# 指令长度（1~3字节）与指令周期的关系  

单字节、双字节指令可能是单周期或双周期的  
3字节指令都为双周期  
乘除法指令为4周期  

# 复位与复位电路  
复位是使CPU和系统中其它部件处于一个确定的初始状态，并从这个状态开始工作  
RST引脚上出现2个周期的高电平时，单片机复位

## 单片机的复位状态
|寄存器|值|
|-|-|
|PC |            0000H |
|ACC |             00H |
|B |                   00H |
|PSW |             00H |
|SP |                 **07H** |
|DPTR |       0000H |
|P0 |           **0FFH** |
|IP |       XX000000 |
|IE |        0X000000 |
|TMOD |         00H |
|TCON |          00H |
|TH0 |              00H |
|TL0 |              00H |
|TH1 |              00H |
|TL1 |              00H |
|SCON |           00H |
|SBUF |          XXH |
|PCON |  X0000 |


## 复位电路  

1. 上电复位电路![](https://github.com/avvount/Picture-Bed/raw/master/%E4%B8%8A%E7%94%B5%E5%A4%8D%E4%BD%8D%E7%94%B5%E8%B7%AF.png)
2. 开关复位电路![](https://github.com/avvount/Picture-Bed/raw/master/%E5%BC%80%E5%85%B3%E5%A4%8D%E4%BD%8D%E7%94%B5%E8%B7%AF.png)
  
  
